new version with bug fixes